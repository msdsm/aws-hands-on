# 第3章

## Lambdaランタイム
- lambdaの実行環境のこと
- Amazon LinuxベースのものとAmazon Linux2ベースのものがある
- サーバーレスと呼ばれるのはこの環境の設定を開発者がやらなくて済むから
- 以下の3点だけ設定する必要がある
  - メモリ
  - タイムアウト
  - IAMロール
- ちなみにLambdaは実行時間ごとに料金が発生するが、割り当てたメモリに比例して単価が高く設定されている

## Lambdaランタイム環境の取得
- コンテキスト引数を通じて取得できる

## Lambdaラインタイム環境の再利用
- イベントをトリガーとしてLambda関数が呼び出されるとLambdaランタイム環境にロードされて実行される
- このロードには時間がかかるため実行後破棄されることなく一定時間保存される
  - ランタイム環境の準備にかかった時間はログのInit Durationにある
- これにより2回目以降の実行時にロードが不必要になる
- そのためコーディングの際に注意する必要がある
  - グローバル領域に記述している文はロード時にしか実行されないため2回目以降の実行でバグが発生するかもしれない
  - 新しいファイルを作成するようなコードにおいて、前回のランタイム環境が保存されている状態で再度実行されると既にファイルがあるためバグが発生するかもしれない

## 同時実行
- イベントが同時に複数発生するとその個数分lambda関数も同時に実行される
- そのため、並列処理に注意してプログラミングする必要がある
- 上限は1000

## プロビジョニング
- ランタイム環境の準備を省き即座にLambda関数を実行できる機能
- ランタイム環境がすでに作られているという状態がずっと保存される
- 実行開始までが一瞬になる一方で、料金が発生する
- プロビジョニングしない構成のことをオンデマンドという

## イベントモデル
- Lambda関数の呼び出しはプッシュモデルとストリームベースの2種類にわかれる
### プッシュモデル
- イベントがLambdaを呼び出す
- Lambdaが返り値を渡す
- さらに、プッシュモデルには同期呼び出しと非同期呼び出しがある
### ストリームベース
- Lambda関数側がイベントソースを流れるデータ(ストリーム)をポーリング(監視)してデータを拾ってくるモデルのこと


### Amazon EventBridge
- cron式でスケジュールを設定できる
- このスケジュールがトリガーした時のアクションを指定できる
- このトリガー時のアクションでlambdaの関数を指定することができるため、lambdaの定時実行が可能